# Create Voldump

This directory contains a script that uses the custom Cuckoo API to run arbitrary volatility tasks to create an IDB designed to be used with the IDA Pro TACO plugin.

The additioe Cuckoo REST API code is available at 

    https://gist.github.com/arbor-jjones/18dd572e6b3e391e8418

And is designed for the development branch of Cuckoo 2.0. The code should be able to be added in at the end of the current cuckoo/util/api.py file and is designed to work with Volatility 2.4

This script should work with Cuckoo 1.2, Cuckoo 1.2/1.3-modified, and Cuckoo 2.0. Its goal is to create as complete a memory dump as possible while also avoiding adding in unnecessary memory regions to keep it to a reasonable size.

create\_voldump.py: Script to use Cuckoo behavioral data to discover interesting memory regions that are used to generate an IDB. Calls idal with the ida\_load\_mem script
ida\_load\_mem.py: A script takes the data generated during the course of create\_voldump.py and automatically generates an IDB file containing the additional memory regions discovered.

Usage and output:
    ```
        $ python create_voldump.py --task 1 --pid 1000 --cuckoo-host cuckoo.host --cuckoo-port cuckoo.port --ida-path /path/to/idal.exe

        [+] Base memory range: 01000000 -> 01005600
        [+] Interesting page: 0x000C0000
        [+] Interesting page: 0x00B40000
        [+] Interesting page: 0x00B50000
        [+] Interesting page: 0x00B60000
        [+] Interesting page 0x000C0000 is in VAD 0x000C0000 - 0x000DCFFF
        [+] Interesting page 0x00B40000 is in VAD 0x00B40000 - 0x00B70FFF
        [+] Interesting page 0x00B50000 is in VAD 0x00B40000 - 0x00B70FFF
        [+] Interesting page 0x00B60000 is in VAD 0x00B40000 - 0x00B70FFF
        [+] Retrieving VAD 0x000C0000
        [+] Retrieving VAD 0x00B40000
        [+] Generating IDB with new memory regions
        [+] IDB available at explorer.exe-3816.idb
    ```



